si_CF=new Date;var _b_w_c={'AppVer':'7_7_1720_0','httpBingHost':'http://www.bing.com','sslBingHost':'https://www.bing.com','httpBingLogHost':'http://a4.bing.com','sslBingLogHost':'https://www.bing.com','prefix':'/widget','sigSample':1,'sigDelay':1500};function _ge(n){return _d.getElementById(n)}function sj_ce(n,t,i){var r=_d.createElement(n);return t&&(r.id=t),i&&(r.className=i),r}function makeLog(){_w.Log_bw=!!_w.Log_bw&&!!_w.Log_bw.Log&&!!_w.Log_bw.RenderPixels&&_w.Log_bw||new function(){function b(){try{return window.self!==window.top}catch(n){return!0}}function l(n,i,e,o,s){var k,p,w,v,l;if(!b()||typeof JSON=="undefined"||o||(k={eventType:n,eventID:i,eventName:e,forceFlush:o,aKeyValPairs:s},bootstrap.core.isBootstrap()||!bootstrap.core.postMessageToParent("doLog:"+JSON.stringify(k)))){if(p="",s)for(w=0;w<s.length;w+=2)v=s[w],l=s[w+1],(typeof v!="string"||v[a]('"')<0)&&(v='"'+v+'"'),typeof l=="string"&&l[a]("{")<0&&l[a]('"')<0&&(l='"'+l+'"'),p+=t(v+":"+l+",");p+=t('"T":"CI.'+n+'",'+(typeof i=="number"?'"K":'+i:'"FID":"'+i+'"')+',"Name":"'+e+'","TS":'+sb_gt()),y[c]+u[c]+p[c]>=h&&r(),u+=t(f?",":"")+t("{")+p+t("}"),f=1,o&&r()}}function e(t,i,r,u){var f=sj_gx();f.open("POST",t,!0),f.setRequestHeader("Content-type",r),f.onreadystatechange=function(){f.status!=200&&n.Log("Error","BW","BS",!1,"Meta",u,"Text",JSON.stringify("unknown error: "+f.status.toString()))},f.send("DS="+i)}function r(){o&&sb_ct(o),f&&(n.ping.src=i+y+u+t("]"),f=0,u=t("[")),o=sb_st(r,v)}var n=this,t=escape,c="length",a="indexOf",s="apply",v=2e3,u=t("["),f=0,w=0,o,h=2e3,i=_G_bw.lsHost!=""?_G_bw.lsHost:"",y=_G_bw.lsUrl+"&TYPE=Event.ClientInst&DATA=",p=location.hostname.match(/([^.]+\.[^.]*)$/);i==""&&p&&(i="http://a4."+p[0]),n.ping=new Image,n.Log=function(n,t,i,u){w||(l("Init","CI","Base",!1),o=sb_st(r,v),w=1,sj_be(_w,"beforeunload",r,!1)),l(n,t,i,u,[].slice.apply(arguments).slice(4))},n.RenderPixels=function(n){var r,t,i,u;if(typeof n!="undefined"&&n!=null)for(r=n.split(";"),t=0;t<r.length;t++)r[t].length>5&&(i=r[t],i+=i.indexOf("?")>-1?"&r"+Math.random():"?r"+Math.random(),u=new Image,u.src=i)},n.PersonalizationImpression=function(n,t,r){var c;if(typeof n!="undefined"&&n!=null&&typeof t!="undefined"&&t!=null&&typeof r!="undefined"&&r!=null){var f=encodeURIComponent(n+t),o=encodeURIComponent(r),u,s=[_b_w_c_t.personalizationImpressionUrl,"&DS=",f,"&Q=",o,"&AT=",Math.floor(+new Date/1e3)].join("");s.length<h?(c=new Image,c.src=s):bootstrap.core.isCrossOriginresourceSharingEnabled()?(u=[_b_w_c_t.personalizationImpressionUrl,"&AT=",Math.floor(+new Date/1e3),"&Q=",o].join(""),e(u,f,"text/plain; charset=utf-8","Log.PersonalizationImpression")):(u=[i,"/widget/cr?PersA=PQ","&PersQ=",o].join(""),e(u,f,"application/x-www-form-urlencoded","Log.PersonalizationImpression"))}},n.PersonalizationClick=function(n,t){var r,u,f,o;typeof t!="undefined"&&t!=null&&typeof n!="undefined"&&n!=null&&(r=encodeURIComponent(n+t),f=[_b_w_c_t.personalizationClickUrl,"&DS=",r,"&AT=",Math.floor(+new Date/1e3)].join(""),f.length<h?(o=new Image,o.src=f):bootstrap.core.isCrossOriginresourceSharingEnabled()?(u=[_b_w_c_t.personalizationClickUrl,"&AT=",Math.floor(+new Date/1e3)].join(""),e(u,r,"text/plain; charset=utf-8","Log.PersonalizationClick")):(u=i+"/widget/cr?PersA=CQ",e(u,r,"application/x-www-form-urlencoded","Log.PersonalizationClick")))},n.Wrap=function(n,t,i,r){var u=n[t];n[t]=function(){var n=arguments,e,t,f;if(r&&i[s](this,n),e=u[s](this,n),!r){for(t=[],f=0;f<n.length;f++)t.push(n[f]);t.push(e),i[s](this,t)}return e}},bootstrap.core.isBootstrap()&&bootstrap.core.parentSupportsPostMessage()&&typeof JSON!="undefined"&&sj_be(_w,"message",function(n){var i,r,u,t;n&&n.data&&typeof n.data=="string"&&(i=n.data.indexOf(":"),i!=-1)&&(r=n.data.substring(0,i),u=n.data.substring(i+1),r==="doLog")&&(t=JSON.parse(u),t&&t.eventType&&l(t.eventType,t.eventID,t.eventName,t.forceFlush,t.aKeyValPairs))},!1)}}var bootstrap;si_ST=new Date,_w=window,_d=document,sb_de=_d.documentElement,sb_ie=!!_w.ActiveXObject,sb_i6=sb_ie&&!_w.XMLHttpRequest,sb_st=_w.setTimeout,sb_ct=_w.clearTimeout,sb_gt=function(){return+new Date},sj_b=_d.body,_G_bw=window._G_bw||{ST:si_ST?si_ST:new Date,Mkt:"en-US",RTL:!1,IG:"",gpUrl:"/fd/ls/GLinkPing.aspx?"},_H={},function(){var e=window.location.href.split("#"),t=e.length>1?e[1]:null,i,r,n,f,u;if(t!==null&&t.length>0)for(t=t.split("&"),i=decodeURIComponent,r=0;r<t.length;r++)if(n=t[r].split("="),n.length==2)_H[n[0]]=i(n[1]);else if(n.length>2){for(f=[],u=1;u<n.length;u++)f.push(i(n[u]));_H[n[0]]=i(f.join("="))}}(),function(){if(_H.IG&&_H.IG.length>0)_G_bw.IG=_H.IG;else if(!_G_bw.IG){function n(){var n=Math.floor(Math.random()*65536).toString(16);return"000".substr(0,4-n.length)+n}_G_bw.IG=[n(),n(),n(),n(),n(),n(),n(),n()].join("").toLowerCase()}}(),_G_bw.lsUrl=(_b_w_c.prefix!=null?_b_w_c.prefix:"")+"/ls/l?IG="+_G_bw.IG,_G_bw.lsHost=_d.location.href.indexOf("https:")==0?_b_w_c.sslBingHost:_b_w_c.httpBingHost,function(n){(function(n){var t=function(){function n(){}return n.isEnabled=function(){return typeof Log_bw!="undefined"&&typeof Log_bw.Log!="undefined"},n.init=function(t,i){n.isEnabled()&&(Log_bw.Log("Init",t,"BS",!1,"Meta",i),Log_bw.RenderPixels(_b_w_c.addImp))},n.info=function(t,i,r,u,f,e){n.isEnabled()&&Log_bw.Log("Info",t,"BS",!1,"R",'"'+i.replace(/"/gi,'\\"')+'"',"S",r,"D",u,"L",f,"E",e)},n.error=function(t,i,r){n.isEnabled()&&Log_bw.Log("Error",t,"BS",!1,"Meta",r,"Text",JSON.stringify(i))},n.id=function(t){n.isEnabled()&&Log_bw.Log("Init","BM","ID",!1,"Meta",t)},n.sig=function(t,i,r){n.isEnabled()&&Log_bw.Log("Init",t,"SG",!1,"Meta",i,"Time",r)},n.pageProperties=function(t,i){i!=null&&i.dims&&n.info(t,i.referrer,i.screen,i.dims,i.language,i.encoding)},n.dims=function(t,i,r,u,f,e,o,s){n.isEnabled()&&Log_bw.Log("Dims",t,"BS",!1,"W",i,"H",r,"Meta",u,"URL",f,"MKT",e,"FC",o,"Method",s||"")},n.click=function(n,t,i){Log_bw.Log("DHTMLClick","BW",n,!1,"Meta",t,"Text",i)},n.latency=function(){n.isEnabled()&&Log_bw.Log("Latency","BW","BS",!1,"Time",sb_gt()-si_ST.getTime())},n.visible=function(t,i){n.isEnabled()&&Log_bw.Log("Visible","BW","BS",!1,"Name","BW","Method",t,"Meta",i)},n.explicit=function(t,i,r,u){n.isEnabled()&&Log_bw.Log("Init","BN","BS",!1,"Meta",t,"Count",i,"Text",r,"FC",u)},n}();n.Logging=t})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(t){function ct(n){var t=[n.type],r=!1,i,u;for(i in n)i!=="type"&&(r||(t.push("~"),r=!0),t.push(i),u=n[i],u!=null&&(t.push("="),t.push(u)),t.push(","));return r&&t.pop(),t.join("")}function r(n,t){var r={},i;if(u(n,r),t)for(i in t)t.hasOwnProperty(i)&&!r.hasOwnProperty(i)&&(r[i]=t[i]);return r}function ht(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function u(n,t){var u=n.split("~"),f,r,i;if(t.type=u[0],u.length==1)return t;for(f=u[1].split(","),r=0;r<f.length;r++)i=f[r].split("="),i.length==1&&i[0].length>0?t[i[0]]=null:i.length>=2&&(t[i[0]]=i[1]);return t}function st(n,t,i){i!=null&&i.length>0&&(n[t]=i)}function i(n,t){if(n&&n.className){var i=" "+n.className+" ";return i.indexOf(" "+t+" ")!==-1}return!1}function ot(n,t){n&&!i(n,t)&&(n.className+=" "+t)}function et(n,t){if(i(n,t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)","g");n.className=n.className.replace(r," ")}}function ft(n,t,r){if(i(n,t)){var u=new RegExp("(\\s|^)"+t+"(\\s|$)","g");n.className=n.className.replace(u," "+r+" ")}}function ut(n){n=n||_w.event,n.stopPropagation?n.stopPropagation():n.returnValue=!1}function rt(n){n=n||_w.event,n.preventDefault?n.preventDefault():n.cancelBubble=!0}function it(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function tt(n,t){try{while(n.parentNode){if(n==t)return!0;n=n.parentNode}while(n.offsetParent){if(n==t)return!0;n=n.offsetParent}}catch(i){}return!1}function nt(n){var t=sj_ce("script"),i;t.type="text/javascript",t.src=n,i=_d.getElementsByTagName("script")[0],i.parentNode.insertBefore(t,i)}function g(n,t,i){var r=sj_gx();r.open("GET",n,!0),r.onreadystatechange=function(){if(r.readyState==4&&r.status==200)try{if(r.responseText){var n=JSON.parse(r.responseText);t(n)}}catch(u){typeof u!="string"&&(u=u.toString()),i&&i(u)}else r.readyState==4&&i("unknown error: "+r.status.toString())},r.send()}function k(n){var i,t,r,u,f,e;try{if(n&&(i=document.getElementsByTagName("script"),i)){for(r=0;r<i.length;r++)if(u=i[r],u&&(f=u.getAttribute("src"),f&&f===n)){t=u;break}if(t){t.parentNode.removeChild(t);for(e in t)delete t[e]}}}catch(o){}}function lt(n){return'"'+n.replace(/"/gi,'\\"').replace(/[\r\n]+/gi," ").replace("\\'","'")+'"'}function b(n,t,i,r){var f="",e="",u;r&&(u=new Date,u.setTime(u.getTime()+r*36e5),f="; expires="+u.toUTCString()),i&&(e="path="+i),document.cookie=[n,"=",t,f,"; ",e].join("")}function a(n){for(var r=n+"=",u=document.cookie.split(";"),t,i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null}function o(n,t){if(!n)return!0;for(var i=0;i<t.length;++i)if(n.indexOf(t[i])>=0)return!1;return!0}function s(n,t){return encodeURIComponent([n,":",'"',t,'"'].join(""))}function w(n,t,i){var r,u,f;return(typeof i=="undefined"&&(i=":"),!t)?"":n=="url"?(r=t.match(c),!r)?"":r[0].toString():n=="global"?"":(u=t.match(h),!u)?"":(f=u[1].toString(),n=="domain")?["domain",i,f].join(""):["host",i,f].join("")}function e(){return!!_w.postMessage&&_w.parent&&!!_w.parent.postMessage}function l(n){return e()?(_w.parent.postMessage(n,"*"),!0):!1}function f(){return _d.location.href.indexOf("https:")==0}function v(n){var t=!1;return t=n!=null?n.isSsl:f(),t?_b_w_c.sslBingHost:_b_w_c.httpBingHost}function y(){return typeof _b_w_c.isCrossOriginResourceSharingEnabled=="undefined"&&(_b_w_c.isCrossOriginResourceSharingEnabled="XMLHttpRequest"in _w&&"withCredentials"in new XMLHttpRequest),_b_w_c.isCrossOriginResourceSharingEnabled}function p(){return _b_w_c.sslBingHost}function d(){return!!n&&!!n.core&&!!n.core.Bootstrap}function at(){_H&&_H.instance&&(_H.slicedinstance=r(_H.instance))}t.serializeInstance=ct,t.sliceInstance=r,t.cloneInstance=ht,t.sliceInstancePreserve=u,t.setProperty=st,t.hasClass=i,t.addClass=ot,t.removeClass=et,t.replaceClass=ft,t.stopPropagation=ut,t.preventDefault=rt,t.removeElement=it,t.withinElement=tt,t.callJsonP=nt,t.callJson=g,t.cleanUpScript=k,t.encodeString=lt,t.setCookie=b,t.getCookie=a,t.isBrowserSupported=o,t.getFiltersKeyValue=s;var h=new RegExp("^http(?:s)?://([^/]+)","im"),c=new RegExp("^http(?:s)?://([^?#]+)(\\?[^&#]+)?","im");t.getPivotUrl=w,t.parentSupportsPostMessage=e,t.postMessageToParent=l,t.isSsl=f,t.getBingHost=v,t.isCrossOriginresourceSharingEnabled=y,t.getSecureBingHost=p,t.isBootstrap=d,at()})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(n){var t=function(){function n(){}return n}();n.PageProperties=t})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(n){var t=function(){function n(n){this.parts=n?n:[]}return n.prototype.add=function(n,t){n&&(n.substr(0,1)!="#"&&this.parts.push("&"),this.parts.push(n),this.parts.push("="),this.parts.push(encodeURIComponent(t||"")))},n.prototype.toArray=function(){return this.parts},n.prototype.toString=function(){return this.parts.join("")},n}();n.QueryParameterBuilder=t})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(n){function r(){return"innerWidth"in _w?_w.innerWidth||null:(sb_de||sj_b).clientWidth||null}function u(){return"innerHeight"in _w?_w.innerHeight||null:(sb_de||sj_b).clientHeight||null}function f(n){return"textContent"in n?n.textContent:n.innerText}function e(n,t){if("textContent"in n){n.textContent=t;return}n.innerText=t}function o(n,t){return n?n.getAttribute(t):null}function t(n,t,i){n&&n.setAttribute(t,i)}function s(n){return n.target||n.srcElement}function h(n){if(n){var t=sj_ce("style");t.type="text/css",t.styleSheet!=null?t.styleSheet.cssText=n:t.appendChild(_d.createTextNode(n)),i(t)}}function i(n){if(_d.head)_d.head.appendChild(n);else{var t=_d.getElementsByTagName("head");t&&t.length>0?t[0].appendChild(n):_d.appendChild(n)}}function c(n,t){var r=sj_ce("script"),u;r.src=n,r.async=!0,u=!1,r.onload=r.onreadystatechange=function(){u||this.readyState&&this.readyState!="loaded"&&this.readyState!="complete"||(u=!0,t(),r.onload=r.onreadystatechange=null)},i(r)}function l(n,i,r,u){var f=(u||_d).createElement("iframe");return f.src=n,f.width=i,f.height=r,f.frameBorder="0",f.scrolling="no",t(f,"allowtransparency","true"),t(f,"transparency","true"),f}function a(n){if(n){var t=sj_ce("link");t.rel="stylesheet",t.href=n,i(t)}}function v(n){var e=[],i,o,r,u,f,t,s;if(_d.getElementsByClassName){if(i=_d.getElementsByClassName(n),i.length>0)for(t=0;t<i.length;++t)e.push(i[t])}else for(o=["div","a","span"],r=null,u=0;u<o.length;++u)if(f=_d.getElementsByTagName(o[u]),f.length>0)for(r==null&&(r=new RegExp("(^| )"+n+"($| )","i")),t=0;t<f.length;++t)s=f[t],s.className.match(r)&&e.push(s);return e}function y(n,t,i,r,u){var f=r[n],e=r[t];return e!==undefined&&e!==null&&(e.indexOf("px")>0||e.indexOf("pc")>0)?i=e:i!==undefined&&i!==null&&(i.indexOf("px")>0||i.indexOf("pc")>0)||(i=f!==undefined&&f!==null&&(f.indexOf("px")>0||f.indexOf("pc")>0)?f:u),i}n.getViewportWidth=r,n.getViewportHeight=u,n.getText=f,n.setText=e,n.getAttr=o,n.setAttr=t,n.getTarget=s,n.addStyle=h,n.getScript=c,n.createIFrame=l,n.addStyleLink=a,n.getTargetsByClassName=v,n.getWidthOrHeightValue=y})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(t){function i(n){try{return!_w.WinJS?_w.top&&!!_w.top.WinJS?!0:n&&n.indexOf("bing_widget_winjs=1")>=0:!0}catch(t){}return!1}function r(t){return t!=null&&n.core.getAttr(t,"data-previewmode")=="true"?!0:window==top}function u(){var t=new n.core.PageProperties,f=_d.location.href||"",h=f.indexOf("#"),u,c,r,o,e,s;return h>=0&&(f=f.substring(0,h)),t.title=_d.title,t.referrer=_d.referrer||"",t.url=f,t.isSsl=n.core.isSsl(),t.url.indexOf(".atdmt.com")>0&&t.referrer&&(t.url=t.referrer,t.referrer=""),t.referrer.length==0&&typeof _bwm_ref_url!="undefined"&&(t.referrer=_bwm_ref_url),u=window.screen,c=navigator,t.screen=u.width+"x"+u.height+"@"+u.colorDepth,t.dims=u.availWidth+"x"+u.availHeight,t.language=(navigator.browserLanguage||navigator.language||"").toLocaleLowerCase(),t.encoding=(document.characterSet||document.charset||"").toLocaleLowerCase(),r=_d.body,o="background-color",r!=null&&(t.background=r.currentStyle&&r.currentStyle[o]||r.currentStyle&&r.currentStyle.backgroundColor,t.background||(e=_d.defaultView,_w.getComputedStyle&&e&&e.getComputedStyle&&(s=e.getComputedStyle(r,null),s&&(t.background=s.getPropertyValue(o))))),t.background=t.background||"rgb(0,0,0)",t.userAgent=navigator.userAgent,t.isWinJs=i(t.url),t}t.isWinJsContext=i,t.isInTop=r,t.inspectPage=u})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(t){function r(t,r,u,f,e){var c=n.core.getAttr(u,"data-market")||"",l=n.core.getAttr(u,"data-color"),a=n.core.getAttr(u,"data-background"),v=n.core.getAttr(u,"data-clickredirect")||"",y=n.core.getAttr(u,"data-clickparams")||"",p=n.core.getAttr(u,"data-clicktarget")||"_blank",w=n.core.getAttr(u,"data-clickaction")||"",b=n.core.getAttr(u,"data-tracking")||"",o=new n.core.QueryParameterBuilder(t),h=!1,s;if(r!=null&&(h=!0,o.add("#IG",i),o.add("url",r.url),o.add("referrer",r.referrer),o.add("title",r.title),o.add("width",r.width),o.add("height",r.height),o.add("type",r.type),o.add("language",r.language),o.add("encoding",r.encoding),o.add("screen",r.screen),o.add("dims",r.dims),o.add("background",a||r.background),o.add("color",l||""),o.add("flavor",r.flavor),o.add("instance",r.instance),o.add("market",c),o.add("formcode",f),o.add("clickredirect",v),o.add("clickparams",y),o.add("clicktarget",p),o.add("clickaction",w),o.add("clicktracking",b)),e)for(s in e)e.hasOwnProperty(s)&&(h?o.add(s,e[s]):(h=!0,o.add("#"+s,e[s])));return o.toString()}function u(n){var t=n.getAttribute("src");t+=t.indexOf("#")<0?"#visible=1":"&visible=1",n.setAttribute("src",t)}var i=_G_bw.IG||"";t.appendInstrumentationQueryParameters=r,t.appendVisibleFlag=u})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(n){function i(n){for(var r=0,u,i,t=0;t<n.length;++t)r+=n[t].Weight;for(u=parseInt(Math.random()*r),i=0,t=0;t<n.length;++t)if(i+=n[t].Weight,i>u)return n[t].Name;return null}function r(n,t,i){var u=(i==null||i.url==null?_d.location.href:i.url).toLowerCase(),r,f;return n==="BWONHI"?"newsrandom":(r=u.indexOf(t),r>-1)?(f=u.indexOf("&",r),f==-1?u.substring(r+t.length):u.substring(r+t.length,f)):null}var t=function(){function n(){}return n.Width="w",n.Height="h",n.WidthOverride="wo",n.HeightOverride="ho",n.AddDataSerpRedirect="adsr",n.LogClickInClickRedirect="oicr",n}();n.Flights=t,n.getFlightAssignment=i,n.getTypeOverrideImpl=r})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){var t=n.core.Logging,i=function(){function i(){var n=this;if(this.getItemCallbacks={},this.callbackIdentifier=0,this.cdFrame=null,this.iframeReady=!1,this.waitQueue=[],this.iframeId="bkwCDFrame",this.iframeUrl="/widget/render/cdstorage",i._instance)throw new Error("Instantiation failed!. Use CrossDomainStorage.getInstance() instead of new.");this.appendIframe(),this.getItemCallbackHandler(),this.cdFrame&&sj_be(this.cdFrame,"load",function(t){return n.iframeLoaded(t)}),i._instance=this}return i.getInstance=function(){return!_w.postMessage||!i.IsLocalStorageSupported()?null:(i._instance===null&&(i._instance=new i),i._instance)},i.prototype.appendIframe=function(){var i=_ge(this.iframeId),t;if(i){this.cdFrame=i,this.iframeReady=!0;return}t=n.core.createIFrame(n.core.getSecureBingHost()+this.iframeUrl,"1px","1px"),t.id=this.iframeId,t.name=this.iframeId,t.style.visibility="hidden",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",_d.body.appendChild(t),this.cdFrame=t},i.prototype.setItem=function(n,t){if(_w.postMessage&&frames[this.iframeId]){var i={action:"setItem",key:n,value:t};this.sendRequest(i)}},i.prototype.removeItem=function(n){if(_w.postMessage&&frames[this.iframeId]){var t={action:"removeItem",key:n};this.sendRequest(t)}},i.prototype.getItem=function(n,t){if(_w.postMessage&&frames[this.iframeId]){var i={action:"getItem",key:n,callbackIdentifier:this.callbackIdentifier};this.getItemCallbacks[this.callbackIdentifier++]=t,this.sendRequest(i)}},i.prototype.sendRequest=function(n){this.iframeReady?frames[this.iframeId].postMessage("cdRequest:"+JSON.stringify(n),"*"):this.waitQueue.push(n)},i.prototype.getItemCallbackHandler=function(){var n=this;sj_be(_w,"message",function(i){var u,f,e,r;if(i&&i.data&&typeof i.data=="string"&&i.source===frames[n.iframeId]&&(u=i.data.indexOf(":"),u!=-1)&&(f=i.data.substring(0,u),f=="cdResponse")){e=i.data.substring(u+1);try{r=JSON.parse(e),"callbackIdentifier"in r&&(n.getItemCallbacks[r.callbackIdentifier](r.value),delete n.getItemCallbacks[r.callbackIdentifier])}catch(o){typeof o!="string"&&(o=o.toString()),t.error("BW",o,"CrossDomainStorage.getItemCallbackHandler")}}},!1)},i.IsLocalStorageSupported=function(){if(typeof JSON!="undefined")try{var n="bw_test";if("localStorage"in _w&&_w.localStorage!==null)return _w.localStorage.setItem(n,"1"),_w.localStorage.removeItem(n),!0}catch(t){return!1}return!1},i.prototype.iframeLoaded=function(){if(this.iframeReady=!0,this.waitQueue.length){for(var t=0;t<this.waitQueue.length;t++)this.sendRequest(this.waitQueue[t]);this.waitQueue=[]}},i._instance=null,i}();n.CrossDomainStorage=i}(bootstrap||(bootstrap={})),function(n){(function(t){var h="/widget/bootstrap.js",c="bing_widget_autosnapshot=1",u=["news.msn.com"],f="bingwidget",l=2,e="300px",o="250px",a="/widget/images/",v="/widget/render/flex/",y="/widget/render/flexnc/",p="/images/widget",i=10,r=10,s;t.config={defaultWidth:e,defaultHeight:o,flexUrl:v,flexNcUrl:y,imageWidgetUrl:p,divClassName:f,moduleLoadWaitTimeout:i,moduleLoadWaitAttempts:r},s=function(){function t(){this.knowledgeWidgetProcessed=!1,this.knowledge=null,this.trending=null,this.stillProcessingRetryNumber=0,this.loadingModules={}}return t.prototype.Run=function(){var t=this;try{makeLog(),n.core.Logging.init("BW",n.core.isInTop()),this.props=n.core.inspectPage(),this.processTrending(this.props),this.processKnowledge(this.props),this.ProcessSignature("BW")}catch(i){typeof i!="string"&&(i=i.toString()),n.core.Logging.error("BW",i,"bootstrap.run"),this.fallback()}sb_st(function(){return t.checkForWidgetsStillProcessing()},4e3)},t.prototype.ProcessSignature=function(n){var t=this;this.shouldLogSignature(this.props)&&(_b_w_c.sigDelay>0?setTimeout(function(){t.loadAndProcessSignature(n)},_b_w_c.sigDelay):this.loadAndProcessSignature(n))},t.prototype.checkForTrendingWidgetsStillProcessing=function(n){if(this.trending){var t=this.getTrendingWidgetTargets();return this.trending.checkForWidgetsStillProcessing(t,n)}return!1},t.prototype.checkForKnowledgeWidgetsStillProcessing=function(n){return this.knowledge?this.knowledge.checkForWidgetsStillProcessing(this.props,n):!1},t.prototype.checkForWidgetsStillProcessing=function(){var r=this,i,t;if(this.stillProcessingRetryNumber<l){i=[],t=!1;try{this.checkForTrendingWidgetsStillProcessing(i)&&(t=!0),this.checkForKnowledgeWidgetsStillProcessing(i)&&(t=!0)}catch(u){typeof u!="string"&&(u=u.toString()),n.core.Logging.error("BW",u,"bootstrap.checkForWidgetsStillProcessing"),t=!0}t&&(n.core.Logging.error("BW","widget not initialized after 4 sec:"+i.join(";"),"bootstrap.checkForWidgetsStillProcessing"),this.stillProcessingRetryNumber++,sb_st(function(){return r.checkForWidgetsStillProcessing()},4e3))}},t.prototype.reprocessAndRunWidget=function(){try{this.reprocessTrending(this.props),this.processKnowledge(this.props)}catch(t){typeof t!="string"&&(t=t.toString()),n.core.Logging.error("BW",t,"bootstrap.reprocessAndRunWidget")}},t.prototype.renderDefault=function(t){var i,r;if(t&&t.getAttribute&&(n.core.getAttr(t,"data-processed")||"").toLowerCase()!=="true"&&(n.core.getAttr(t,"data-processing")||"").toLowerCase()!=="true"){n.core.setAttr(t,"data-processing","true"),i=n.core.getAttr(t,"data-width")||n.core.getAttr(t,"bing_widget_width"),r=n.core.getAttr(t,"data-height")||n.core.getAttr(t,"bing_widget_height"),i=n.core.getWidthOrHeightValue(n.core.Flights.Width,n.core.Flights.WidthOverride,i,{},e),r=n.core.getWidthOrHeightValue(n.core.Flights.Height,n.core.Flights.HeightOverride,r,{},o);var s=(i.toString()+r.toString()).toLowerCase(),h=_b_w_c.fallback[s]||_b_w_c.fallback[""],u=n.core.getBingHost(null),c=[u,a,h].join(""),l=['<a href="',u,'"><img src="',c,'" /></a>'].join(""),f=sj_ce("span");f.innerHTML=l,t.parentNode.replaceChild(f,t),n.core.setAttr(t,"data-processing","false"),n.core.setAttr(t,"data-processed","true")}},t.prototype.fallback=function(){var t,i;try{if(t=this.getTrendingWidgetTargets(),t!=null)for(i=0;i<t.length;++i)this.renderDefault(t[i]);else n.core.Logging.error("BW","target not found","bootstrap.fallback");this.knowledge&&this.knowledge.fallback()}catch(r){typeof r!="string"&&(r=r.toString()),n.core.Logging.error("BW",r,"bootstrap.fallback")}},t.prototype.loadAndProcessSignature=function(t){var e=this,f,u="signature";f=function(r){n.signature?(e.loadingModules[u]=!1,n.signature.processSignature(t)):r>0?sb_st(function(){return f(r-1)},i):(e.loadingModules[u]=!1,n.core.Logging.error("BW","signature module load failed","bootstrap.loadAndProcessSignature"))},n.signature?f(0):this.loadingModules[u]?sb_st(function(){return f(r)},i):(this.loadingModules[u]=!0,sj_jbc(u,!1,function(){return f(r)},function(){return e.loadingModules[u]=!1}))},t.prototype.isMsnHomepage=function(n){return n!=null&&n.url!=null&&n.url.indexOf("www.msn.com/")>=0?!0:!1},t.prototype.shouldLogSignature=function(n){if(_b_w_c.sigSample<=0||this.isMsnHomepage(n))return!1;var t=Math.random();return t<_b_w_c.sigSample},t.prototype.autoSnapshotEnabled=function(t,i){for(var e,f,r=0;r<t.length;r++)if((n.core.getAttr(t[r],"data-autosnapshot")||"").toLowerCase()=="true")return t[r];if(i&&i.url){if(i.url.indexOf(c)>=0)return t[0];for(e=n.core.getPivotUrl("host",i.url).replace("host:",""),f=0;f<u.length;f++)if(u[f]==e)return t[0]}return null},t.prototype.autoSnapshotManual=function(t){for(var i=0;i<t.length;i++)if((n.core.getAttr(t[i],"data-autosnapshotmanual")||"").toLowerCase()=="true")return!0;return!1},t.prototype.findScripts=function(){var i=[],r=_d.getElementsByTagName("script"),u,t;for(u in r)t=r[u],t&&t.src&&t.src.indexOf(h)>=0?i.push(t):t&&t.getAttribute&&n.core.getAttr(t,"data-source")=="bingwidget"&&i.push(t);return i},t.prototype.processKnowledge=function(t){var f=this,i;if(!this.knowledgeWidgetProcessed){if(i=this.findScripts(),i.length==0)return;if(!_b_w_c.snapshot||!n.core.isInTop(i[0])&&!t.isWinJs)return;var r=this.autoSnapshotEnabled(i,t),e=r!=null,u=!this.autoSnapshotManual(i);if(!e)return;this.knowledgeWidgetProcessed=!0,_b_w_c.snapshotDelay>0?setTimeout(function(){f.loadKnowledgeWidget(t,r,!u)},_b_w_c.snapshotDelay):this.loadKnowledgeWidget(t,r,!u)}},t.prototype.loadKnowledgeWidget=function(t,u,f){var e=this,s,o="knowledge";s=function(r){n.knowledge?(e.loadingModules[o]=!1,e.knowledge||(e.knowledge=new n.knowledge.Knowledge(u)),e.knowledge.go(t,u,f)):r>0?sb_st(function(){return s(r-1)},i):(e.loadingModules[o]=!1,n.core.Logging.error("BW","knowledge module load failed","bootstrap.loadKnowledgeWidget"))},n.knowledge?s(0):this.loadingModules[o]?sb_st(function(){return s(r)},i):(this.loadingModules[o]=!0,sj_jbc(o,!1,function(){return s(r)},function(){return e.loadingModules[o]=!1}))},t.prototype.getTrendingWidgetTargets=function(){var i=n.core.getTargetsByClassName(f),t,r;return i.length==0&&(t=this.findScripts(),t.length>0&&(r=this.autoSnapshotEnabled(t,this.props),r||n.core.isInTop(t[0])||i.push(t[0]))),i},t.prototype.processTrending=function(n){var t=this.getTrendingWidgetTargets();t&&t.length>0&&this.loadAndExecuteTrending(n,t)},t.prototype.reprocessTrending=function(t){for(var r=this.getTrendingWidgetTargets(),u=[],i=0;i<r.length;i++)(n.core.getAttr(r[i],"data-processing")||"").toLowerCase()!=="true"&&(n.core.getAttr(r[i],"data-processed")||"").toLowerCase()!=="true"&&u.push(r[i]);u.length>0&&this.loadAndExecuteTrending(t,u)},t.prototype.loadAndExecuteTrending=function(t,u){var f=this,e,o;!u||u.length<1||(e=this.isMsnHomepage(t)?"trendingtext":"trending",o=function(r){if(!n.trending)r>0?sb_st(function(){return o(r-1)},i):(f.loadingModules[e]=!1,n.core.Logging.error("BW","trending module load failed","bootstrap.loadAndExecuteTrending"),f.fallback());else{if(f.loadingModules[e]=!1,!f.trending)try{f.trending=new n.trending.TrendingWidget(t)}catch(s){typeof s!="string"&&(s=s.toString()),n.core.Logging.error("BW",s,"bootstrap.loadAndExecuteTrending"),f.fallback()}if(f.trending)try{f.trending.go(u)}catch(s){typeof s!="string"&&(s=s.toString()),n.core.Logging.error("BW",s,"bootstrap.loadAndExecuteTrending"),f.fallback()}}},n.trending?o(0):this.loadingModules[e]?sb_st(function(){return o(r)},i):(this.loadingModules[e]=!0,sj_jbc(e,!1,function(){return o(r)},function(){f.loadingModules[e]=!1,f.fallback()})))},t.prototype.invokeSnapshotDebugger=function(){this.knowledge&&this.knowledge.invokeSnapshotDebugger()},t}(),t.Bootstrap=s})(n.core||(n.core={}));var t=n.core}(bootstrap||(bootstrap={})),function(n){(function(n){var t=function(){function n(){this.SIZE_OF_SIGNATURE=32,this.tokenHashAggregation=[],this.numTokens=0,this.currentHash=0;for(var n=0;n<this.SIZE_OF_SIGNATURE;++n)this.tokenHashAggregation[n]=0}return n.prototype.AddTokenToLocation=function(n){this.tokenHashAggregation[n]=this.tokenHashAggregation[n]==0?1:0,this.numTokens++},n.prototype.AddToken=function(n){this.AddTokenToLocation(n%this.SIZE_OF_SIGNATURE)},n.prototype.CalculateHash=function(){for(var t=0,n=0;n<this.tokenHashAggregation.length;n++)t<<=1,t|=this.tokenHashAggregation[n];this.currentHash=t},n.prototype.GetHashValue=function(){return this.currentHash},n.prototype.GetHashValueAsString=function(){var t=this.currentHash,n,i;return t<0&&(t=4294967295+t+1),n=t.toString(16).toLowerCase(),i=this.SIZE_OF_SIGNATURE/4,n.length>=i?n:new Array(i-n.length+1).join("0")+n},n.prototype.GetNumTokens=function(){return this.numTokens},n}();n.DocHash=t})(n.signature||(n.signature={}));var t=n.signature}(bootstrap||(bootstrap={})),function(n){(function(t){function e(n){if(!n||n.nodeType!=3||!n.nodeValue)return null;var r=n.nodeValue,t=r.replace(i,"");return t.length==0?null:t}function o(n){if(!n)return null;var t=n.replace(i,"");return t.length==0?null:t}function s(n){var t,i,u,r;return!n||!n.href?null:(t=n.attributes.href,!t||t.value.length==0)?null:(t=t.value,i=t.indexOf("#"),u=t.indexOf("?"),i>=0&&t.length>i+1&&t[i+1]=="!"&&(i=-1,u=-1),r=i,u>=0&&(r<0||r>u)&&(r=u),r>=0&&(t=t.substring(0,r)),t.length==0)?null:t}function h(t,i){var h=new n.signature.DocHash,c,d,l,y,p,w;if(!i)return null;var v=0,b=0,k=o(t);k!==null&&(h.AddToken(k.length),++v);for(var a=[{e:i,i:0}],g=0,nt=+new Date;a.length>0;){if(c=a[a.length-1],c.i>=c.e.childNodes.length){a.pop();continue}while(c.i<c.e.childNodes.length){if(++g%f==0&&(d=+new Date-nt,d>u))return null;if(l=c.e.childNodes[c.i++],l.nodeType==3)y=e(l),y!==null&&(h.AddToken(y.length),++v);else if(l.nodeType==1&&(p=l,!r[p.tagName])){p.tagName=="A"&&(w=s(l),w!==null&&(h.AddToken(w.length),++b)),a.push({e:l,i:0});break}}}return h.AddToken(v),h.AddToken(b),h.CalculateHash(),h.GetHashValueAsString()}var i=/[ \r\n\t\f\v!"#$%^&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~]/g,r={SCRIPT:1,STYLE:1,IFRAME:1,OBJECT:1,EMBED:1,AUDIO:1,VIDEO:1,CANVAS:1,FRAME:1,FRAMESET:1,NOSCRIPT:1,TEXTAREA:1},u=100,f=100;t.getDocumentSignature=h})(n.signature||(n.signature={}));var t=n.signature}(bootstrap||(bootstrap={})),function(n){(function(t){function r(){return n.core.isInTop()?n.signature.getDocumentSignature(document.title,document.body):null}function u(n){try{var u=sb_gt(),t=r(),f=sb_gt()-u;t!==null&&i.sig(n,t,f)}catch(e){typeof e!="string"&&(e=e.toString()),i.error(n,e,"bootstrap.sig")}}function f(){try{makeLog(),i.init("BM",n.core.isInTop()),_w._bwmid&&i.id(_w._bwmid),i.pageProperties("BM",n.core.inspectPage());var t=new n.core.Bootstrap;t.ProcessSignature("BM")}catch(r){typeof r!="string"&&(r=r.toString()),i.error("BM",r,"bootstrap.run")}}var i=n.core.Logging;t.processSignature=u,t.run=f})(n.signature||(n.signature={}));var t=n.signature}(bootstrap||(bootstrap={})),bootstrap.signature.run()